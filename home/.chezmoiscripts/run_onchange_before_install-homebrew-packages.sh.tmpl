{{- if and (eq .osid "darwin" "linux-debian" "linux-ubuntu") .personal -}}

{{- $brews := list
  "age"
  "bat"
  "btop"
  "eza"
  "fastfetch"
  "fish"
  "fzf"
  "git-delta"
  "glow"
  "lazygit"
  "neovim"
  "starship"
  "thefuck"
  "tldr"
  "tmux"
  "yazi"
-}}

{{- if eq .osid "darwin" -}}
{{-   $brews = concat $brews (list
  "git"
  "sketchybar"
  "skhd"
  "yabai"
) -}}
{{- end -}}

{{- $casks := list
  "font-maple"
-}}

#!/bin/bash

set -euo pipefail

function install_homebrew() {
  echo -e "\033[0;32m>>>>> Installing Homebrew <<<<<\033[0m"
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
  echo >> ~/.bashrc
  echo 'eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"' >> ~/.bashrc
  eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
}

if ! $(brew -v &> /dev/null); then
  install_homebrew
fi

echo -e "\033[0;32m>>>>> Installing Homebrew Packages <<<<<\033[0m"
brew bundle -v --no-lock --file=/dev/stdin <<EOF
{{ range ( $brews | sortAlpha | uniq ) -}}
brew {{ . | quote }}
{{ end -}}
{{ if eq .osid "darwin" -}}
{{   range ( $casks | sortAlpha | uniq ) -}}
cask {{ . | quote }}
{{   end -}}
{{ end -}}
EOF

{{- end -}}
